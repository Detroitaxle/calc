<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Refund & Payment Calculator</title>
  <style>
    :root {
      --primary: #6d9eeb;
      --secondary: #8ab4f8;
      --refund: #81c784;
      --payment: #f48fb1;
      --warning: #ffb74d;
      --danger: #f44336;
      --dark-bg: #121212;
      --dark-surface: #1e1e1e;
      --dark-text: #e0e0e0;
      --dark-border: #333;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: var(--dark-bg);
      margin: 0;
      padding: 20px;
      color: var(--dark-text);
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      background: var(--dark-surface);
      padding: 25px;
      border-radius: 10px;
      border: 1px solid var(--dark-border);
    }

    h1 {
      text-align: center;
      color: var(--primary);
    }

    .calculator-container {
      display: flex;
      gap: 30px;
      margin-bottom: 30px;
    }

    .calculator-section {
      flex: 1;
      background: #252525;
      padding: 20px;
      border-radius: 8px;
      border: 1px solid var(--dark-border);
    }

    h2 {
      color: var(--primary);
      margin-top: 0;
      border-bottom: 2px solid var(--secondary);
      padding-bottom: 10px;
    }

    .item-row {
      display: flex;
      align-items: center;
      margin-bottom: 12px;
      gap: 10px;
    }

    .input-wrapper {
      flex-grow: 1;
      position: relative;
    }

    .input-wrapper input {
      width: 100%;
      padding: 10px 10px 10px 25px;
      background-color: #333;
      color: var(--dark-text);
      border: 1px solid #444;
      border-radius: 4px;
    }

    .currency {
      position: absolute;
      left: 10px;
      top: 50%;
      transform: translateY(-50%);
      color: #999;
    }

    .btn {
      padding: 6px 12px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 600;
      transition: 0.3s;
    }

    .btn-add {
      background-color: var(--primary);
      color: white;
      width: 100%;
    }

    .btn-remove {
      background-color: #444;
      color: white;
      padding: 8px;
      min-width: 30px;
    }

    .btn-clear {
      background-color: var(--danger);
      color: white;
      margin-top: 15px;
      padding: 5px 10px;
      font-size: 0.9em;
      display: none;
    }

    .total-row {
      margin-top: 15px;
      font-weight: bold;
    }

    .result-box {
      margin-top: 30px;
      padding: 20px;
      border-radius: 8px;
      text-align: center;
      font-weight: bold;
      border: 2px solid;
    }

    .refund-result {
      background-color: #1b3a1f;
      color: var(--refund);
      border-color: var(--refund);
    }

    .payment-result {
      background-color: #3a1b1b;
      color: var(--payment);
      border-color: var(--payment);
    }

    .balanced {
      background-color: #2a2a2a;
      color: var(--warning);
      border-color: var(--warning);
    }

    @media (max-width: 768px) {
      .calculator-container {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Refund & Payment Calculator</h1>
    <div class="calculator-container">
      <section id="returns-section" class="calculator-section">
        <h2>Refunds</h2>
        <button class="btn btn-add" onclick="addReturnItem()">+ Add Refund</button>
        <div id="returns-items"></div>
        <div class="total-row">Total Refunds: <span id="returns-total">$0.00</span></div>
      </section>
      <section id="payments-section" class="calculator-section">
        <h2>Payments</h2>
        <button class="btn btn-add" onclick="addPaymentItem()">+ Add Payment</button>
        <div id="payments-items"></div>
        <div class="total-row">Total Payments: <span id="payments-total">$0.00</span></div>
      </section>
    </div>
    <div id="result" class="result-box balanced">Enter amounts to calculate balance</div>
    <button class="btn btn-clear" id="clear-btn" onclick="clearAll()">Clear All</button>
  </div>
  <script>
    (function() {
      let itemId = 0;
      const elements = {
        returnsItems: document.getElementById('returns-items'),
        paymentsItems: document.getElementById('payments-items'),
        returnsTotal: document.getElementById('returns-total'),
        paymentsTotal: document.getElementById('payments-total'),
        result: document.getElementById('result'),
        clearBtn: document.getElementById('clear-btn')
      };

      function init() {
        addReturnItem('', false);
        addPaymentItem('', false);
      }

      function addReturnItem(value = '', focus = true) {
        const id = `return-${itemId++}`;
        const item = createItemRow(id, value);
        elements.returnsItems.appendChild(item);
        if (focus) item.querySelector('input').focus();
        calculateTotals();
      }

      function addPaymentItem(value = '', focus = true) {
        const id = `payment-${itemId++}`;
        const item = createItemRow(id, value);
        elements.paymentsItems.appendChild(item);
        if (focus) item.querySelector('input').focus();
        calculateTotals();
      }

      function createItemRow(id, value) {
        const item = document.createElement('div');
        item.className = 'item-row';
        item.id = id;
        item.innerHTML = `
          <div class="input-wrapper">
            <span class="currency">$</span>
            <input type="number" min="0" step="0.01" placeholder="0.00" value="${value}" />
          </div>
          <button class="btn btn-remove" onclick="removeItem('${id}')">&times;</button>
        `;
        const input = item.querySelector('input');
        input.addEventListener('input', calculateTotals);
        input.addEventListener('keydown', (e) => {
          if (e.key === 'Enter') {
            if (item.id.startsWith('return')) addReturnItem();
            else addPaymentItem();
          }
        });
        return item;
      }

      function removeItem(id) {
        const el = document.getElementById(id);
        if (el) {
          el.remove();
          calculateTotals();
        }
      }

      function clearAll() {
        elements.returnsItems.innerHTML = '';
        elements.paymentsItems.innerHTML = '';
        addReturnItem('', false);
        addPaymentItem('', false);
        calculateTotals();
      }

      function formatCurrency(num) {
        return '$' + parseFloat(num).toFixed(2);
      }

      function calculateTotals() {
        const refunds = getTotal(elements.returnsItems);
        const payments = getTotal(elements.paymentsItems);
        elements.returnsTotal.textContent = formatCurrency(refunds);
        elements.paymentsTotal.textContent = formatCurrency(payments);
        const difference = refunds - payments;

        if (difference > 0) {
          elements.result.textContent = `Customer gets ${formatCurrency(difference)} refund`;
          elements.result.className = 'result-box refund-result';
        } else if (difference < 0) {
          elements.result.textContent = `Customer needs to pay ${formatCurrency(Math.abs(difference))}`;
          elements.result.className = 'result-box payment-result';
        } else {
          elements.result.textContent = 'Amounts are balanced';
          elements.result.className = 'result-box balanced';
        }

        // Show clear button only if there are non-zero entries
        const hasNumbers = [...document.querySelectorAll('input[type="number"]')]
          .some(input => parseFloat(input.value));
        elements.clearBtn.style.display = hasNumbers ? 'inline-block' : 'none';
      }

      function getTotal(container) {
        return Array.from(container.querySelectorAll('input'))
          .reduce((acc, input) => acc + (parseFloat(input.value) || 0), 0);
      }

      window.addReturnItem = addReturnItem;
      window.addPaymentItem = addPaymentItem;
      window.removeItem = removeItem;
      window.clearAll = clearAll;

      window.addEventListener('DOMContentLoaded', init);
    })();
  </script>
</body>
</html>
